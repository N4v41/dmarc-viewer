{% extends 'myDmarcApp/base.html' %}
{# Load the tag library #}
{% load bootstrap3 %}

{% block title %}MyDmarc - View Editor{% endblock %}

{% block content %}
<div class="col-sm-3 col-md-2 sidebar">
    <ul class="nav nav-sidebar">
    {% for view in sidebar_views %}
        <li {% if view_form.instance.id and view_form.instance.id == view.id %} class="active" {% endif %} >
            <a href="/edit/{{view.id}}/">{{view.title}}</a>
        </li>
    {% endfor %}
    </ul>
</div>
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    <h1>Editor</h1>
    {% bootstrap_messages %}
    <form id="viewFilterForm" method='post' action='/edit/{% if view_form.instance.id %}{{view_form.instance.id}}/ {% endif %}' class="form">
         {% csrf_token %}
        <h2>View</h2>

        {% bootstrap_form view_form %}

        <div>
            <h4>Time</h4>
            {% bootstrap_form_errors view_time_fixed_form %}
            <div class="row">
                <div class="col-md-2">
                    <input type="radio" name="time_switch" disabled>
                </div>
                <div class="col-md-4">
                    {% bootstrap_field view_time_fixed_form.date_range_begin layout='inline' %}
                </div>
                <div class="col-md-4">
                    {% bootstrap_field view_time_fixed_form.date_range_end layout='inline' %}
                </div>
            </div>
            <div class="row">
                <div class="col-md-2">
                    <input type="radio" name="time_switch" disabled>
                </div>
                <div class="col-md-4">
                    {% bootstrap_field view_time_variable_form.quantity layout='inline' %}
                </div>
                <div class="col-md-4">
                    {% bootstrap_field view_time_variable_form.unit layout='inline' %}
                </div>
            </div>
        </div>


        <div id="filterSetContainer">
            <h3>Filters</h3>
            <div id="filterSetTemplate" class="filterSet" style="display:none">
                <h4>Filter</h4>
                {% bootstrap_form filter_set_formset.empty_form %}
                {% for key, filter_formset in filter_formsets.items %}
                    {% bootstrap_form filter_formset.0 %}
                {% endfor %}
            </div>
            {% for filter_set_form in filter_set_formset%}
                <div class="filterSet">
                    <h4>Filter</h4>
                    {% bootstrap_form filter_set_form %}
                {% for key, filter_formset in filter_formsets.items  %}
                    {% bootstrap_form filter_formset.0 %}
                {% endfor %}
            </div>
            {% endfor %}

            {{ filter_set_formset.management_form }}

        </div>
        <input class="form-control btn btn-warning" type="submit" value="Y U DO TIZ JOKR?! ;(">
    </form>
</div>

<script type="text/javascript">
    $(function() {
        $('#filterSetContainer .filterSet').formset({formTemplate : '#filterSetTemplate', prefix : 'filterset_set'});
    })
</script>
{% endblock %}
